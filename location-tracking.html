<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/apt/location-tracking.apt at 2025-06-04
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <meta name="author" content="Benjamin Bentmann" />
    <meta name="date" content="2010-04-18" />
    <title>Location Tracking – Modello</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.1.0.min.js"></script>
    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        _paq.push(['disableCookies']);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);

        (function() {
            var u="https://analytics.apache.org/";
            _paq.push(['setTrackerUrl', u+'/matomo.php']);
            _paq.push(['setSiteId', '18']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1><a href="./">Modello</a></h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li><a href="../">Plexus</a><span class="divider">/</span></li>
      <li><a href="../plexus-pom">Parent POM</a><span class="divider">/</span></li>
      <li><a href="index.html">Modello</a><span class="divider">/</span></li>
    <li class="active">Location Tracking <a href="https://github.com/codehaus-plexus/modello/tree/modello-2.5.1/src/site/apt/location-tracking.apt"><img src="./images/accessories-text-editor.png" alt="Edit" /></a></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2025-06-04</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 2.5.1</li>
        <li class="pull-right"><a href="https://maven.apache.org/">Apache Maven</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html">Introduction</a></li>
    <li><a href="modello.html">Modello Model</a></li>
    <li class="active"><a>Location Tracking</a></li>
    <li><a href="modello-maven-plugin/">Maven Plugin</a></li>
    <li><a href="release-notes.html">Release Notes</a></li>
    <li><a href="migration-guide.html">Migration Guide</a></li>
   <li class="nav-header">Modules</li>
    <li><a href="modello-maven-plugin/index.html">Modello Maven Plugin</a></li>
    <li><a href="modello-core/index.html">Modello Core</a></li>
    <li><a href="modello-test/index.html">Modello Test Package</a></li>
    <li><a href="modello-plugins/index.html">Modello Plugins</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
   <li class="nav-header">Plexus Projects</li>
    <li><a href="../plexus-archiver/">Plexus Archiver</a></li>
    <li><a href="../plexus-classworlds/">Plexus Classworlds</a></li>
    <li><a href="../plexus-compiler/">Plexus Compiler</a></li>
    <li><a href="../plexus-i18n/">Plexus i18n</a></li>
    <li><a href="../plexus-interactivity/">Plexus Interactivity</a></li>
    <li><a href="../plexus-interpolation/">Plexus Interpolation</a></li>
    <li><a href="../plexus-io/">Plexus IO</a></li>
    <li><a href="../plexus-languages/">Plexus Languages</a></li>
    <li><a href="./">Plexus Modello</a></li>
    <li><a href="../plexus-pom/">Plexus Parent POM</a></li>
    <li><a href="../plexus-resources/">Plexus Resources</a></li>
    <li><a href="../plexus-utils/">Plexus Utils</a></li>
    <li><a href="../plexus-velocity/">Plexus Velocity</a></li>
    <li><a href="../plexus-xml/">Plexus XML</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="https://codehaus-plexus.github.io/" name="sitesearch" type="hidden" />
  <input class="search-query" name="q" id="query" type="text" placeholder="Search with Google..." />
</form>
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="Location_Tracking"></a>
<h1>Location Tracking</h1>
<p>Starting with Modello 1.4, some parsers (only <a href="./modello-plugins/modello-plugin-xpp3/index.html">XPP3</a> in 1.4, <a href="./modello-plugins/modello-plugin-snakeyaml/">Snake Yaml</a> and <a href="./modello-plugins/modello-plugin-jackson/">Jackson</a> in addition in 1.8) support the tracking of line/column information for the input data. This means that additional metadata is stored in the model that can be used to query the location of some model element in the input source, e.g. for means of better error reporting to the user.</p><section><a id="Base_Principle"></a>
<h2>Base Principle</h2>
<p>For performance reasons, generation of location metadata during parsing has to be explicitly requested. Usually, this means to use an <i>extended</i> reader instead of the normal reader generated by Modello, for example <code>xpp3-extended-reader</code>.</p>
<p>To store the line/column information, one class of the model has to be specifically attributed:</p>
<pre class="prettyprint linenums"><code>&lt;class locationTracker=&quot;locations&quot; java.clone=&quot;shallow&quot;&gt;
  &lt;name&gt;Location&lt;/name&gt;
  &lt;version&gt;1.0.0+&lt;/version&gt;
  &lt;fields&gt;
    &lt;!-- line and column fields are auto-generated by Modello, and optional reference to source (see &quot;Source Tracking&quot; section below) --&gt;
  &lt;/fields&gt;
&lt;/class&gt;</code></pre>
<p>The attribute <code>locationTracker</code> in the snippet above signals to Modello that this class should be used to record line/column metadata during parsing. The class can be modelled as usual, but the <code>line</code> and <code>column</code> fields to save the line and column number along with their accessors are automatically generated by Modello (and optional reference to source).</p>
<p>A <code>Tracker</code> interface will be generated to factor out accessors to <code>locationTracker</code>:</p>
<pre class="prettyprint linenums"><code>public interface LocationTracker // named by adding &quot;Tracker&quot; to location tracker class name
{
    public Location getLocation( Object field );
    public void setLocation( Object field, Location location );
}</code></pre>
<p>All other model classes will be equipped with a field to hold instances of the <code>Location</code> class and implement <code>Tracker</code> accessors to query them. The value of <code>locationTracker</code> attribute is used to name this field. This way, each model class keeps track of the input locations for its fields:</p>
<pre class="prettyprint linenums"><code>public class Model implements LocationTracker
{

    private Map&lt;Object, Location&gt; locations; // named after .mdo locationTracker attribute value

    public Location getLocation( Object field )
    {
        return ( locations != null ) ? locations.get( field ) : null;
    }

    [...]

}</code></pre></section><section><a id="Location_Map_Keys"></a>
<h2>Location Map Keys</h2>
<p>The location map shown above is keyed by field name. An empty string is used to query the location of the bean itself (or its text contents).</p>
<p>For collections or maps, the returned <code>Location</code> instance can be further queried for its items (<code>Location</code> implements <code>LocationTracker</code>). The key to query an item depends on the type of collection. For lists the zero-based index is used, for sets the item itself is used and for maps/properties the mapping key is used.</p>
<p>For example, consider this input XML:</p>
<pre class="prettyprint linenums"><code>&lt;model&gt;
  &lt;someString&gt;hello&lt;/someString&gt;
  &lt;listItems&gt;
    &lt;listItem&gt;list&lt;/listItem&gt;
  &lt;/listItems&gt;
  &lt;setItems&gt;
    &lt;setItem&gt;set&lt;/setItem&gt;
  &lt;/setItems&gt;
  &lt;properties&gt;
    &lt;key&gt;value&lt;/key&gt;
  &lt;/properties&gt;
&lt;/model&gt;</code></pre>
<p>For this data model, one could query the location metadata like this (neglecting null checking):</p>
<pre class="prettyprint linenums"><code>Model model = &lt;parser invocation&gt;;

// to query the location of the &lt;model&gt; element itself
Location location1 = model.getLocation( &quot;&quot; );

// to query the location of the contents of &lt;someString&gt;, i.e. &quot;hello&quot;
Location location2 = model.getLocation( &quot;someString&quot; );

// to query the location of the first list item, i.e. &quot;list&quot;
Location location3 = model.getLocation( &quot;listItems&quot; ).getLocation( Integer.valueOf( 0 ) );

// to query the location of the set item, i.e. &quot;set&quot;
Location location4 = model.getLocation( &quot;setItems&quot; ).getLocation( &quot;set&quot; );

// to query the location of the properties data, i.e. &quot;value&quot;
Location location5 = model.getLocation( &quot;properties&quot; ).getLocation( &quot;key&quot; );</code></pre></section><section><a id="Source_Tracking"></a>
<h2>Source Tracking</h2>
<p>Occasionally, just tracking the line/column number is not enough but the input file of the model needs to be recorded as well. For this reason, another class of the model can be marked as a <b>source tracker</b>:</p>
<pre class="prettyprint linenums"><code>&lt;class sourceTracker=&quot;source&quot;&gt;
  &lt;name&gt;Source&lt;/name&gt;
  &lt;version&gt;1.0.0+&lt;/version&gt;
  &lt;fields&gt;
    &lt;!-- modelled by end-user, e.g. fields to hold pathname/URL etc. --&gt;
  &lt;/fields&gt;
&lt;/class&gt;</code></pre>
<p>The fields of this source tracking class are entirely up to the application, Modello will merely extend the generated <code>Location</code> class to support a reference to the <code>Source</code> class named after the value of <code>sourceTracker</code> attribute.</p>
<p>An instance of the source tracking class has to be provided to the extended readers, which will then use it to populate all the generated <code>Location</code> instances.</p></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2001–2025
<a href="https://codehaus-plexus.github.io/">Codehaus Plexus</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>